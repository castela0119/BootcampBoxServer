# ğŸš€ Rookie PX Server API ì—”ë“œí¬ì¸íŠ¸ (Flutter í˜¸ì¶œìš©)

## ğŸ“± ê¸°ë³¸ ì •ë³´
- **Base URL**: http://localhost:8080 (ê°œë°œ) / https://your-domain.com (ìš´ì˜)
- **Content-Type**: application/json
- **Authorization**: Bearer {JWT_TOKEN} (ë¡œê·¸ì¸ í•„ìš” API)

---

## ğŸ” ì¸ì¦/íšŒì›ê°€ì… API

### 1. íšŒì›ê°€ì…
```
POST /api/auth/signup
Content-Type: application/json

Request Body:
{
  "email": "user@example.com",
  "phoneNumber": "010-1234-5678",
  "password": "password123",
  "nickname": "ì‚¬ìš©ìë‹‰ë„¤ì„",
  "userType": "ACTIVE_DUTY", // ACTIVE_DUTY, VETERAN, CIVILIAN
  "branch": "ìœ¡êµ°", // ìœ¡êµ°, í•´êµ°, ê³µêµ°, í•´ë³‘ëŒ€
  "unit": "1ì‚¬ë‹¨",
  "militaryRank": "ë³‘ì¥",
  "enlistDate": "2023-01-01",
  "dischargeDate": "2024-12-31",
  "address": "ì„œìš¸ì‹œ ê°•ë‚¨êµ¬",
  "addressDetail": "123-45",
  "zipcode": "12345"
}

Response:
{
  "message": "íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.",
  "success": true,
  "userId": 1
}
```

### 2. ë¡œê·¸ì¸
```
POST /api/auth/login
Content-Type: application/json

Request Body:
{
  "phoneNumber": "010-1234-5678",
  "password": "password123"
}

Response:
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "userId": 1,
  "nickname": "ì‚¬ìš©ìë‹‰ë„¤ì„",
  "role": "USER"
}
```

### 3. ë¡œê·¸ì•„ì›ƒ
```
POST /api/auth/logout
Authorization: Bearer {JWT_TOKEN}

Response:
"ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤."
```

### 4. ì¤‘ë³µí™•ì¸
```
POST /api/auth/check-duplicate
Content-Type: application/json

Request Body:
{
  "type": "EMAIL", // EMAIL, NICKNAME
  "value": "ì´ë©”ì¼ ë˜ëŠ” ë‹‰ë„¤ì„ê°’"
}

Response:
{
  "message": "ì‚¬ìš© ê°€ëŠ¥í•œ ì´ë©”ì¼ì…ë‹ˆë‹¤.",
  "available": true,
  "duplicate": false
}
```

### 4-1. ì´ë©”ì¼ ì¤‘ë³µí™•ì¸ (ê°œë³„)
```
GET /api/auth/check-email/{email}

Response:
{
  "message": "ì‚¬ìš© ê°€ëŠ¥í•œ ì´ë©”ì¼ì…ë‹ˆë‹¤.",
  "available": true,
  "duplicate": false
}
```

### 4-2. ë‹‰ë„¤ì„ ì¤‘ë³µí™•ì¸ (ê°œë³„)
```
GET /api/auth/check-nickname/{nickname}

Response:
{
  "message": "ì‚¬ìš© ê°€ëŠ¥í•œ ë‹‰ë„¤ì„ì…ë‹ˆë‹¤.",
  "available": true,
  "duplicate": false
}
```

### 5. ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •
```
POST /api/auth/reset-password
Content-Type: application/json

Request Body:
{
  "phoneNumber": "010-1234-5678",
  "newPassword": "ìƒˆë¹„ë°€ë²ˆí˜¸123"
}

Response:
{
  "message": "ë¹„ë°€ë²ˆí˜¸ê°€ ì„±ê³µì ìœ¼ë¡œ ì¬ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.",
  "success": true
}
```

---

## ğŸ‘¤ ë§ˆì´í˜ì´ì§€ API

### 6. ë‚´ ì •ë³´ ì¡°íšŒ
```
GET /api/user/me
Authorization: Bearer {JWT_TOKEN}

Response:
{
  "userId": 1,
  "phoneNumber": "010-1234-5678",
  "nickname": "ì‚¬ìš©ìë‹‰ë„¤ì„",
  "username": "ì‚¬ìš©ìì•„ì´ë””",
  "userType": "ACTIVE_DUTY",
  "branch": "ìœ¡êµ°",
  "unit": "1ì‚¬ë‹¨",
  "militaryRank": "ë³‘ì¥",
  "enlistDate": "2023-01-01",
  "dischargeDate": "2024-12-31",
  "address": "ì„œìš¸ì‹œ ê°•ë‚¨êµ¬",
  "addressDetail": "123-45",
  "zipcode": "12345",
  "createdAt": "2024-01-01T00:00:00"
}
```

### 7. ë‚´ ì •ë³´ ìˆ˜ì •
```
PATCH /api/user/me
Authorization: Bearer {JWT_TOKEN}
Content-Type: application/json

Request Body:
{
  "nickname": "ìƒˆë‹‰ë„¤ì„",
  "unit": "2ì‚¬ë‹¨",
  "militaryRank": "ìƒë³‘",
  "address": "ì„œìš¸ì‹œ ì„œì´ˆêµ¬",
  "addressDetail": "456-78",
  "zipcode": "54321"
}

Response:
{
  "message": "ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.",
  "success": true,
  "userInfo": { ... }
}
```

### 8. ë‚´ê°€ ì“´ ê¸€ ëª©ë¡
```
GET /api/user/me/posts?page=0&size=10
Authorization: Bearer {JWT_TOKEN}

Response:
{
  "content": [
    {
      "postId": 1,
      "title": "ê²Œì‹œê¸€ ì œëª©",
      "content": "ê²Œì‹œê¸€ ë‚´ìš©",
      "category": "ììœ ê²Œì‹œíŒ",
      "viewCount": 10,
      "commentCount": 5,
      "likeCount": 3,
      "createdAt": "2024-01-01T00:00:00"
    }
  ],
  "totalElements": 1,
  "totalPages": 1,
  "size": 10,
  "number": 0
}
```

### 9. ë‚´ê°€ ì¢‹ì•„ìš”í•œ ê¸€ ëª©ë¡
```
GET /api/user/me/likes
Authorization: Bearer {JWT_TOKEN}

Response:
{
  "postIds": [1, 2, 3],
  "count": 3
}
```

### 10. ë‚´ê°€ ë¶ë§ˆí¬í•œ ê¸€ ëª©ë¡
```
GET /api/user/me/bookmarks
Authorization: Bearer {JWT_TOKEN}

Response:
{
  "postIds": [1, 2, 3],
  "count": 3
}
```

### 11. ë‚´ í™œë™ ìš”ì•½
```
GET /api/user/me/activity-summary
Authorization: Bearer {JWT_TOKEN}

Response:
{
  "totalPosts": 5,
  "totalLikes": 10,
  "totalBookmarks": 3,
  "recentActivity": [
    {
      "type": "POST",
      "title": "ê²Œì‹œê¸€ ì œëª©",
      "createdAt": "2024-01-01T00:00:00"
    }
  ]
}
```

---

## ğŸ”” ì•Œë¦¼ API

### 12. ì•Œë¦¼ ëª©ë¡ ì¡°íšŒ
```
GET /notifications
Authorization: Bearer {JWT_TOKEN}

Response:
{
  "notifications": [
    {
      "id": 1,
      "type": "LIKE",
      "message": "ê²Œì‹œê¸€ì— ì¢‹ì•„ìš”ê°€ ë‹¬ë ¸ìŠµë‹ˆë‹¤.",
      "isRead": false,
      "createdAt": "2024-01-01T00:00:00"
    }
  ],
  "unreadCount": 1
}
```

### 13. ì•Œë¦¼ ì½ìŒ ì²˜ë¦¬
```
PATCH /notifications/read
Authorization: Bearer {JWT_TOKEN}

Response:
{
  "message": "ëª¨ë“  ì•Œë¦¼ì´ ì½ìŒ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.",
  "success": true
}
```

---

## ğŸ›ï¸ PX ìƒí’ˆ API

### 14. ìƒí’ˆ ëª©ë¡ ì¡°íšŒ
```
GET /api/products?page=0&size=12

Response:
{
  "products": [
    {
      "id": 1,
      "name": "ìƒí’ˆëª…",
      "description": "ìƒí’ˆ ì„¤ëª…",
      "price": 10000,
      "category": "ì‹í’ˆ",
      "imageUrl": "https://example.com/image.jpg",
      "externalLink": "https://example.com/product"
    }
  ],
  "totalElements": 1,
  "totalPages": 1,
  "size": 12,
  "number": 0
}
```

### 15. ì¹´í…Œê³ ë¦¬ë³„ ìƒí’ˆ ëª©ë¡
```
GET /api/products/category/ì‹í’ˆ?page=0&size=12

Response: (ìœ„ì™€ ë™ì¼í•œ í˜•ì‹)
```

### 16. ìƒí’ˆ ê²€ìƒ‰
```
GET /api/products/search?keyword=ìƒí’ˆëª…&page=0&size=12

Response: (ìœ„ì™€ ë™ì¼í•œ í˜•ì‹)
```

### 17. ì¹´í…Œê³ ë¦¬ë³„ ìƒí’ˆ ê²€ìƒ‰
```
GET /api/products/category/ì‹í’ˆ/search?keyword=ìƒí’ˆëª…&page=0&size=12

Response: (ìœ„ì™€ ë™ì¼í•œ í˜•ì‹)
```

### 18. ëª¨ë“  ì¹´í…Œê³ ë¦¬ ì¡°íšŒ
```
GET /api/products/categories

Response:
{
  "categories": ["ì‹í’ˆ", "ì˜ë¥˜", "ì „ìì œí’ˆ", "ìƒí™œìš©í’ˆ"]
}
```

---

## ğŸ’¬ ì»¤ë®¤ë‹ˆí‹° API

### 19. ê²Œì‹œê¸€ ëª©ë¡ ì¡°íšŒ
```
GET /api/posts?page=0&size=10

Response:
{
  "content": [
    {
      "postId": 1,
      "title": "ê²Œì‹œê¸€ ì œëª©",
      "content": "ê²Œì‹œê¸€ ë‚´ìš©",
      "author": "ì‘ì„±ìë‹‰ë„¤ì„",
      "category": "ììœ ê²Œì‹œíŒ",
      "viewCount": 10,
      "commentCount": 5,
      "likeCount": 3,
      "createdAt": "2024-01-01T00:00:00"
    }
  ],
  "totalElements": 1,
  "totalPages": 1,
  "size": 10,
  "number": 0
}
```

### 20. ê²Œì‹œê¸€ ìƒì„¸ ì¡°íšŒ
```
GET /api/posts/{postId}

Response:
{
  "postId": 1,
  "title": "ê²Œì‹œê¸€ ì œëª©",
  "content": "ê²Œì‹œê¸€ ë‚´ìš©",
  "author": "ì‘ì„±ìë‹‰ë„¤ì„",
  "category": "ììœ ê²Œì‹œíŒ",
  "viewCount": 10,
  "commentCount": 5,
  "likeCount": 3,
  "isLiked": false,
  "isBookmarked": false,
  "createdAt": "2024-01-01T00:00:00"
}
```

### 21. ê²Œì‹œê¸€ ì‘ì„±
```
POST /api/posts?userId={userId}
Authorization: Bearer {JWT_TOKEN}
Content-Type: application/json

Request Body:
{
  "title": "ê²Œì‹œê¸€ ì œëª©",
  "content": "ê²Œì‹œê¸€ ë‚´ìš©",
  "category": "ììœ ê²Œì‹œíŒ"
}

Response:
{
  "postId": 1,
  "title": "ê²Œì‹œê¸€ ì œëª©",
  "content": "ê²Œì‹œê¸€ ë‚´ìš©",
  "author": "ì‘ì„±ìë‹‰ë„¤ì„",
  "category": "ììœ ê²Œì‹œíŒ",
  "createdAt": "2024-01-01T00:00:00"
}
```

### 22. ê²Œì‹œê¸€ ìˆ˜ì •
```
PUT /api/posts/{postId}?userId={userId}
Authorization: Bearer {JWT_TOKEN}
Content-Type: application/json

Request Body:
{
  "title": "ìˆ˜ì •ëœ ì œëª©",
  "content": "ìˆ˜ì •ëœ ë‚´ìš©",
  "category": "ììœ ê²Œì‹œíŒ"
}

Response: (ê²Œì‹œê¸€ ìƒì„¸ì™€ ë™ì¼)
```

### 23. ê²Œì‹œê¸€ ì‚­ì œ
```
DELETE /api/posts/{postId}?userId={userId}
Authorization: Bearer {JWT_TOKEN}

Response: 200 OK
```

### 24. ê²Œì‹œê¸€ ì¢‹ì•„ìš”
```
POST /api/posts/{postId}/like
Authorization: Bearer {JWT_TOKEN}

Response:
{
  "message": "ì¢‹ì•„ìš”ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.",
  "likeCount": 4,
  "isLiked": true,
  "isBookmarked": false,
  "success": true
}
```

### 25. ê²Œì‹œê¸€ ì¢‹ì•„ìš” ì·¨ì†Œ
```
DELETE /api/posts/{postId}/like
Authorization: Bearer {JWT_TOKEN}

Response:
{
  "message": "ì¢‹ì•„ìš”ê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.",
  "likeCount": 3,
  "isLiked": false,
  "isBookmarked": false,
  "success": true
}
```

### 26. ê²Œì‹œê¸€ ë¶ë§ˆí¬
```
POST /api/posts/{postId}/bookmark
Authorization: Bearer {JWT_TOKEN}

Response:
{
  "message": "ë¶ë§ˆí¬ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.",
  "likeCount": 3,
  "isLiked": false,
  "isBookmarked": true,
  "success": true
}
```

### 27. ê²Œì‹œê¸€ ë¶ë§ˆí¬ ì·¨ì†Œ
```
DELETE /api/posts/{postId}/bookmark
Authorization: Bearer {JWT_TOKEN}

Response:
{
  "message": "ë¶ë§ˆí¬ê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.",
  "likeCount": 3,
  "isLiked": false,
  "isBookmarked": false,
  "success": true
}
```

### 28. ê²Œì‹œê¸€ ì‹ ê³ 
```
POST /api/posts/{postId}/report
Authorization: Bearer {JWT_TOKEN}
Content-Type: application/json

Request Body:
{
  "reason": "ë¶€ì ì ˆí•œ ë‚´ìš©"
}

Response:
{
  "message": "ì‹ ê³ ê°€ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤.",
  "success": true
}
```

### 29. ì‚¬ìš©ìë³„ ê²Œì‹œê¸€ ëª©ë¡
```
GET /api/posts/user/{userId}?page=0&size=10

Response: (ê²Œì‹œê¸€ ëª©ë¡ê³¼ ë™ì¼í•œ í˜•ì‹)
```

---

## ğŸ’­ ëŒ“ê¸€ API

### 30. ëŒ“ê¸€ ëª©ë¡ ì¡°íšŒ
```
GET /api/posts/{postId}/comments

Response:
{
  "comments": [
    {
      "commentId": 1,
      "content": "ëŒ“ê¸€ ë‚´ìš©",
      "author": "ì‘ì„±ìë‹‰ë„¤ì„",
      "likeCount": 2,
      "isLiked": false,
      "createdAt": "2024-01-01T00:00:00",
      "replies": [
        {
          "commentId": 2,
          "content": "ëŒ€ëŒ“ê¸€ ë‚´ìš©",
          "author": "ì‘ì„±ìë‹‰ë„¤ì„",
          "likeCount": 1,
          "isLiked": false,
          "createdAt": "2024-01-01T00:00:00"
        }
      ]
    }
  ]
}
```

### 31. ëŒ“ê¸€ ì‘ì„±
```
POST /api/posts/{postId}/comments
Authorization: Bearer {JWT_TOKEN}
Content-Type: application/json

Request Body:
{
  "content": "ëŒ“ê¸€ ë‚´ìš©",
  "parentId": null // ëŒ€ëŒ“ê¸€ì¸ ê²½ìš° ë¶€ëª¨ ëŒ“ê¸€ ID
}

Response:
{
  "commentId": 1,
  "content": "ëŒ“ê¸€ ë‚´ìš©",
  "author": "ì‘ì„±ìë‹‰ë„¤ì„",
  "likeCount": 0,
  "isLiked": false,
  "createdAt": "2024-01-01T00:00:00"
}
```

### 32. ëŒ“ê¸€ ìˆ˜ì •
```
PATCH /api/posts/comments/{commentId}
Authorization: Bearer {JWT_TOKEN}
Content-Type: application/json

Request Body:
{
  "content": "ìˆ˜ì •ëœ ëŒ“ê¸€ ë‚´ìš©"
}

Response: (ëŒ“ê¸€ ì‘ì„± ì‘ë‹µê³¼ ë™ì¼)
```

### 33. ëŒ“ê¸€ ì‚­ì œ
```
DELETE /api/posts/comments/{commentId}
Authorization: Bearer {JWT_TOKEN}

Response: 200 OK
```

### 34. ëŒ“ê¸€ ì¢‹ì•„ìš”
```
POST /api/posts/comments/{commentId}/like
Authorization: Bearer {JWT_TOKEN}

Response:
{
  "message": "ëŒ“ê¸€ ì¢‹ì•„ìš”ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.",
  "likeCount": 3,
  "isLiked": true,
  "success": true
}
```

### 35. ëŒ“ê¸€ ì¢‹ì•„ìš” ì·¨ì†Œ
```
DELETE /api/posts/comments/{commentId}/like
Authorization: Bearer {JWT_TOKEN}

Response:
{
  "message": "ëŒ“ê¸€ ì¢‹ì•„ìš”ê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.",
  "likeCount": 2,
  "isLiked": false,
  "success": true
}
```

### 36. ëŒ“ê¸€ ì‹ ê³ 
```
POST /api/posts/comments/{commentId}/report
Authorization: Bearer {JWT_TOKEN}
Content-Type: application/json

Request Body:
{
  "reason": "ë¶€ì ì ˆí•œ ëŒ“ê¸€"
}

Response:
{
  "message": "ëŒ“ê¸€ ì‹ ê³ ê°€ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤.",
  "success": true
}
```

### 37. ë‚´ ëŒ“ê¸€ ëª©ë¡
```
GET /api/posts/user/me/comments
Authorization: Bearer {JWT_TOKEN}

Response:
{
  "comments": [
    {
      "commentId": 1,
      "content": "ëŒ“ê¸€ ë‚´ìš©",
      "postTitle": "ê²Œì‹œê¸€ ì œëª©",
      "createdAt": "2024-01-01T00:00:00"
    }
  ]
}
```

---

## ğŸ”§ Flutter í˜¸ì¶œ ì˜ˆì‹œ

### HTTP í´ë¼ì´ì–¸íŠ¸ ì„¤ì •
```dart
import 'package:http/http.dart' as http;
import 'dart:convert';

class ApiService {
  static const String baseUrl = 'http://localhost:8080';
  static String? token;

  static Map<String, String> get headers {
    Map<String, String> headers = {
      'Content-Type': 'application/json',
    };
    if (token != null) {
      headers['Authorization'] = 'Bearer $token';
    }
    return headers;
  }

  // ë¡œê·¸ì¸ ì˜ˆì‹œ
  static Future<Map<String, dynamic>> login(String phoneNumber, String password) async {
    final response = await http.post(
      Uri.parse('$baseUrl/api/auth/login'),
      headers: headers,
      body: jsonEncode({
        'phoneNumber': phoneNumber,
        'password': password,
      }),
    );

    if (response.statusCode == 200) {
      final data = jsonDecode(response.body);
      token = data['token']; // í† í° ì €ì¥
      return data;
    } else {
      throw Exception('ë¡œê·¸ì¸ ì‹¤íŒ¨');
    }
  }

  // ê²Œì‹œê¸€ ëª©ë¡ ì¡°íšŒ ì˜ˆì‹œ
  static Future<List<dynamic>> getPosts({int page = 0, int size = 10}) async {
    final response = await http.get(
      Uri.parse('$baseUrl/api/posts?page=$page&size=$size'),
      headers: headers,
    );

    if (response.statusCode == 200) {
      final data = jsonDecode(response.body);
      return data['content'];
    } else {
      throw Exception('ê²Œì‹œê¸€ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨');
    }
  }
}
```

### ì‚¬ìš© ì˜ˆì‹œ
```dart
// ë¡œê·¸ì¸
try {
  final loginData = await ApiService.login('010-1234-5678', 'password123');
  print('ë¡œê·¸ì¸ ì„±ê³µ: ${loginData['nickname']}');
} catch (e) {
  print('ë¡œê·¸ì¸ ì‹¤íŒ¨: $e');
}

// ê²Œì‹œê¸€ ëª©ë¡ ì¡°íšŒ
try {
  final posts = await ApiService.getPosts(page: 0, size: 10);
  print('ê²Œì‹œê¸€ ${posts.length}ê°œ ì¡°íšŒë¨');
} catch (e) {
  print('ê²Œì‹œê¸€ ì¡°íšŒ ì‹¤íŒ¨: $e');
}
```

---

## ğŸ“ ì£¼ì˜ì‚¬í•­

1. **JWT í† í°**: ë¡œê·¸ì¸ í›„ ë°›ì€ í† í°ì„ Authorization í—¤ë”ì— í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.
2. **ì—ëŸ¬ ì²˜ë¦¬**: ëª¨ë“  API í˜¸ì¶œ ì‹œ ì ì ˆí•œ ì—ëŸ¬ ì²˜ë¦¬ë¥¼ êµ¬í˜„í•˜ì„¸ìš”.
3. **í˜ì´ì§•**: ëª©ë¡ ì¡°íšŒ APIëŠ” page, size íŒŒë¼ë¯¸í„°ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.
4. **í™˜ê²½ ì„¤ì •**: ê°œë°œ/ìš´ì˜ í™˜ê²½ì— ë”°ë¼ baseUrlì„ ë³€ê²½í•˜ì„¸ìš”.
5. **Content-Type**: POST/PUT ìš”ì²­ ì‹œ application/jsonì„ ì„¤ì •í•˜ì„¸ìš”.

---

## ğŸš¨ ì—ëŸ¬ ì‘ë‹µ í˜•ì‹

```json
{
  "error": "ì—ëŸ¬ ë©”ì‹œì§€",
  "status": 400,
  "timestamp": "2024-01-01T00:00:00"
}
```

---

## ğŸ“± Flutter íŒ¨í‚¤ì§€ ì˜ì¡´ì„±

```yaml
dependencies:
  http: ^1.1.0
  shared_preferences: ^2.2.2  # í† í° ì €ì¥ìš©
  flutter_secure_storage: ^9.0.0  # ë³´ì•ˆ í† í° ì €ì¥ìš©
``` 