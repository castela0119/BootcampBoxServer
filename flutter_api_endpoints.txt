# Flutter API ì—°ë™ ëª…ì„¸ì„œ - ì¢‹ì•„ìš” ê¸°ëŠ¥

## ğŸ¯ ì¢‹ì•„ìš” í† ê¸€ API (ê¶Œì¥)

### ê²Œì‹œê¸€ ì¢‹ì•„ìš” í† ê¸€
```dart
import 'package:http/http.dart' as http;
import 'dart:convert';

class ApiService {
  static const String baseUrl = 'http://localhost:8080';
  static String? token;

  static Map<String, String> get headers {
    Map<String, String> headers = {
      'Content-Type': 'application/json',
    };
    if (token != null) {
      headers['Authorization'] = 'Bearer $token';
    }
    return headers;
  }

  // ê²Œì‹œê¸€ ì¢‹ì•„ìš” í† ê¸€ (ì¶”ê°€/ì·¨ì†Œ)
  static Future<Map<String, dynamic>> togglePostLike(int postId) async {
    final response = await http.post(
      Uri.parse('$baseUrl/api/posts/$postId/toggle-like'),
      headers: {
        'Content-Type': 'application/json',
        'Authorization': 'Bearer $token',
      },
    );
    
    if (response.statusCode == 200) {
      return json.decode(response.body);
    } else {
      throw Exception('ì¢‹ì•„ìš” í† ê¸€ ì‹¤íŒ¨');
    }
  }
}
```

**ì‘ë‹µ ì˜ˆì‹œ:**
```json
{
  "message": "ì¢‹ì•„ìš”ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.",
  "count": 5,
  "liked": true,
  "reported": false,
  "bookmarked": false
}
```

### ëŒ“ê¸€ ì¢‹ì•„ìš” í† ê¸€
```dart
import 'package:http/http.dart' as http;
import 'dart:convert';

class ApiService {
  static const String baseUrl = 'http://localhost:8080';
  static String? token;

  static Map<String, String> get headers {
    Map<String, String> headers = {
      'Content-Type': 'application/json',
    };
    if (token != null) {
      headers['Authorization'] = 'Bearer $token';
    }
    return headers;
  }

  // ëŒ“ê¸€ ì¢‹ì•„ìš” í† ê¸€ (ì¶”ê°€/ì·¨ì†Œ)
  static Future<Map<String, dynamic>> toggleCommentLike(int commentId) async {
    final response = await http.post(
      Uri.parse('$baseUrl/api/comments/$commentId/toggle-like'),
      headers: {
        'Content-Type': 'application/json',
        'Authorization': 'Bearer $token',
      },
    );
    
    if (response.statusCode == 200) {
      return json.decode(response.body);
    } else {
      throw Exception('ëŒ“ê¸€ ì¢‹ì•„ìš” í† ê¸€ ì‹¤íŒ¨');
    }
  }
}
```

**ì‘ë‹µ ì˜ˆì‹œ:**
```json
{
  "message": "ì¢‹ì•„ìš”ê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.",
  "count": 3,
  "liked": false
}
```

## âš ï¸ ì¤‘ìš” ì‚¬í•­

### 1. ì—”ë“œí¬ì¸íŠ¸ ë³€ê²½
- **ê¸°ì¡´**: `/api/posts/{id}/like` (POST/DELETE)
- **ë³€ê²½**: `/api/posts/{id}/toggle-like` (POST)

### 2. í† ê¸€ ë°©ì‹
- í•œ ë²ˆ í˜¸ì¶œí•˜ë©´ ì¢‹ì•„ìš” ì¶”ê°€
- ë‹¤ì‹œ í˜¸ì¶œí•˜ë©´ ì¢‹ì•„ìš” ì·¨ì†Œ
- ì‘ë‹µì˜ `liked` í•„ë“œë¡œ í˜„ì¬ ìƒíƒœ í™•ì¸

### 3. ì‘ë‹µ í•„ë“œ
- `count`: í˜„ì¬ ì¢‹ì•„ìš” ìˆ˜
- `liked`: í˜„ì¬ ì‚¬ìš©ìì˜ ì¢‹ì•„ìš” ìƒíƒœ (true/false)
- `message`: ì‘ì—… ê²°ê³¼ ë©”ì‹œì§€

## ğŸ”§ ì‚¬ìš© ì˜ˆì‹œ

```dart
class PostDetailPage extends StatefulWidget {
  @override
  _PostDetailPageState createState() => _PostDetailPageState();
}

class _PostDetailPageState extends State<PostDetailPage> {
  bool isLiked = false;
  int likeCount = 0;
  
  // ì¢‹ì•„ìš” í† ê¸€
  Future<void> _toggleLike() async {
    try {
      final result = await togglePostLike(widget.postId);
      setState(() {
        isLiked = result['liked'];
        likeCount = result['count'];
      });
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(content: Text(result['message'])),
      );
    } catch (e) {
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(content: Text('ì¢‹ì•„ìš” ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.')),
      );
    }
  }
  
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: Text('ê²Œì‹œê¸€ ìƒì„¸')),
      body: Column(
        children: [
          // ê²Œì‹œê¸€ ë‚´ìš©...
          
          // ì¢‹ì•„ìš” ë²„íŠ¼
          Row(
            children: [
              IconButton(
                icon: Icon(
                  isLiked ? Icons.favorite : Icons.favorite_border,
                  color: isLiked ? Colors.red : Colors.grey,
                ),
                onPressed: _toggleLike,
              ),
              Text('$likeCount'),
            ],
          ),
        ],
      ),
    );
  }
}
```

## ğŸ“ API í…ŒìŠ¤íŠ¸

### curl ëª…ë ¹ì–´ë¡œ í…ŒìŠ¤íŠ¸
```bash
# ê²Œì‹œê¸€ ì¢‹ì•„ìš” í† ê¸€
curl -X POST http://localhost:8080/api/posts/24/toggle-like \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"

# ëŒ“ê¸€ ì¢‹ì•„ìš” í† ê¸€
curl -X POST http://localhost:8080/api/comments/15/toggle-like \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

## ğŸš¨ ì£¼ì˜ì‚¬í•­

1. **JWT í† í° í•„ìˆ˜**: ëª¨ë“  ì¢‹ì•„ìš” APIëŠ” ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤.
2. **í† ê¸€ ë°©ì‹**: ì¢‹ì•„ìš” ì¶”ê°€/ì·¨ì†Œë¥¼ í•˜ë‚˜ì˜ ì—”ë“œí¬ì¸íŠ¸ë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤.
3. **ìƒíƒœ ë™ê¸°í™”**: ì‘ë‹µì˜ `liked` í•„ë“œë¡œ UI ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•˜ì„¸ìš”.
4. **ì—ëŸ¬ ì²˜ë¦¬**: ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ë‚˜ ì¸ì¦ ì‹¤íŒ¨ ì‹œ ì ì ˆí•œ ì—ëŸ¬ ì²˜ë¦¬ê°€ í•„ìš”í•©ë‹ˆë‹¤.

## ğŸ“‹ êµ¬í˜„ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] Flutterì—ì„œ `/toggle-like` ì—”ë“œí¬ì¸íŠ¸ ì‚¬ìš©
- [ ] ì¢‹ì•„ìš” ë²„íŠ¼ UI êµ¬í˜„ (ì•„ì´ì½˜ ë³€ê²½)
- [ ] ì¢‹ì•„ìš” ìˆ˜ í‘œì‹œ
- [ ] í† ê¸€ ìƒíƒœì— ë”°ë¥¸ UI ì—…ë°ì´íŠ¸
- [ ] ì—ëŸ¬ ì²˜ë¦¬ ë° ì‚¬ìš©ì í”¼ë“œë°±
- [ ] JWT í† í° ì¸ì¦ ì²˜ë¦¬ 