# Rookie PX Server - Cursor Rules

## ğŸ¯ í”„ë¡œì íŠ¸ ê°œìš”
- **í”„ë¡œì íŠ¸ëª…**: Rookie PX Server (Spring Boot 3.5.3)
- **ì–¸ì–´**: Java 17
- **ë°ì´í„°ë² ì´ìŠ¤**: MySQL 8.0
- **ë¹Œë“œ ë„êµ¬**: Gradle
- **ì£¼ìš” ê¸°ëŠ¥**: íšŒì›ê°€ì…/ë¡œê·¸ì¸, ì»¤ë®¤ë‹ˆí‹°, PX ìƒí’ˆ, ì•Œë¦¼

## ğŸ“‹ ì½”ë”© ê·œì¹™

### 1. Java ì½”ë”© ìŠ¤íƒ€ì¼
- **í´ë˜ìŠ¤ëª…**: PascalCase (ì˜ˆ: `UserService`, `DuplicateCheckController`)
- **ë©”ì„œë“œëª…**: camelCase (ì˜ˆ: `checkEmailDuplicate`, `createUser`)
- **ë³€ìˆ˜ëª…**: camelCase (ì˜ˆ: `userEmail`, `isVerified`)
- **ìƒìˆ˜ëª…**: UPPER_SNAKE_CASE (ì˜ˆ: `JWT_SECRET`, `MAX_RETRY_COUNT`)
- **íŒ¨í‚¤ì§€ëª…**: ì†Œë¬¸ì (ì˜ˆ: `com.bootcampbox.server.service`)

### 2. íŒŒì¼ êµ¬ì¡°
```
src/main/java/com/bootcampbox/server/
â”œâ”€â”€ config/          # ì„¤ì • í´ë˜ìŠ¤ë“¤
â”œâ”€â”€ controller/      # REST API ì»¨íŠ¸ë¡¤ëŸ¬
â”œâ”€â”€ domain/          # JPA ì—”í‹°í‹°
â”œâ”€â”€ dto/            # ë°ì´í„° ì „ì†¡ ê°ì²´
â”œâ”€â”€ repository/     # JPA ë¦¬í¬ì§€í† ë¦¬
â”œâ”€â”€ service/        # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â””â”€â”€ util/           # ìœ í‹¸ë¦¬í‹° í´ë˜ìŠ¤
```

### 3. ë„¤ì´ë° ì»¨ë²¤ì…˜
- **Controller**: `*Controller` (ì˜ˆ: `AuthController`, `UserController`)
- **Service**: `*Service` (ì˜ˆ: `UserService`, `AuthService`)
- **Repository**: `*Repository` (ì˜ˆ: `UserRepository`, `PostRepository`)
- **Entity**: ë‹¨ìˆ˜í˜• (ì˜ˆ: `User`, `Post`, `Comment`)
- **DTO**: `*Dto` (ì˜ˆ: `UserDto`, `LoginRequestDto`)

## ğŸ›¡ï¸ ì—ëŸ¬ ì²˜ë¦¬ ê·œì¹™

### 1. ì˜ˆì™¸ ì²˜ë¦¬ íŒ¨í„´
```java
// ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì˜ˆì™¸ ì²˜ë¦¬
@PostMapping("/signup")
public ResponseEntity<?> signUp(@Valid @RequestBody UserDto.SignUpRequest request) {
    try {
        log.info("íšŒì›ê°€ì… ìš”ì²­: {}", request.getEmail());
        UserDto.SignUpResponse response = userService.signUp(request);
        return ResponseEntity.ok(response);
    } catch (Exception e) {
        log.error("íšŒì›ê°€ì… ì˜¤ë¥˜: ", e);
        return ResponseEntity.badRequest().body("íšŒì›ê°€ì… ì‹¤íŒ¨: " + e.getMessage());
    }
}
```

### 2. ê²€ì¦ ì˜ˆì™¸ ì²˜ë¦¬
```java
// í•„ìˆ˜ í•„ë“œ ê²€ì¦
@NotBlank(message = "ì´ë©”ì¼ì€ í•„ìˆ˜ ì…ë ¥ê°’ì…ë‹ˆë‹¤.")
@Pattern(regexp = "^[A-Za-z0-9+_.-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}$", 
         message = "ì´ë©”ì¼ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.")
private String email;
```

### 3. ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì˜ˆì™¸ ì²˜ë¦¬
```java
// ì¤‘ë³µ ê²€ì‚¬
if (userRepository.existsByEmail(request.getEmail())) {
    throw new IllegalArgumentException("ì´ë¯¸ ê°€ì…ëœ ì´ë©”ì¼ì…ë‹ˆë‹¤.");
}
```

## ğŸ“ ë¡œê¹… ê·œì¹™

### 1. ë¡œê·¸ ë ˆë²¨ ì‚¬ìš©
- **ERROR**: ì˜ˆì™¸ ë°œìƒ, ì‹œìŠ¤í…œ ì˜¤ë¥˜
- **WARN**: ê²½ê³  ìƒí™©, ì˜ˆìƒì¹˜ ëª»í•œ ìƒíƒœ
- **INFO**: ì¤‘ìš”í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ì´ë²¤íŠ¸
- **DEBUG**: ë””ë²„ê¹… ì •ë³´, SQL ì¿¼ë¦¬
- **TRACE**: ìƒì„¸í•œ ì‹¤í–‰ íë¦„

### 2. ë¡œê·¸ ë©”ì‹œì§€ í˜•ì‹
```java
// ìš”ì²­ ì‹œì‘
log.info("=== íšŒì›ê°€ì… ìš”ì²­ ì‹œì‘ ===");
log.info("ìš”ì²­ ì´ë©”ì¼: {}", request.getEmail());

// ì²˜ë¦¬ ê³¼ì •
log.info("ì´ë©”ì¼ ì¤‘ë³µí™•ì¸ ì™„ë£Œ: {}", isDuplicate);

// ìš”ì²­ ì™„ë£Œ
log.info("=== íšŒì›ê°€ì… ìš”ì²­ ì™„ë£Œ ===");
```

### 3. ë¡œê·¸ ì„¤ì • (application-local.properties)
```properties
logging.level.root=INFO
logging.level.com.bootcampbox.server=DEBUG
logging.level.org.springframework.security=DEBUG
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
```

## ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ê·œì¹™

### 1. MySQL ì„¤ì •
```properties
# MySQL ì—°ê²° ì„¤ì •
spring.datasource.url=jdbc:mysql://localhost:3306/rookie_db?useSSL=false&serverTimezone=UTC&characterEncoding=UTF-8&allowPublicKeyRetrieval=true
spring.datasource.username=root
spring.datasource.password=rookie123
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# JPA ì„¤ì •
spring.jpa.hibernate.ddl-auto=create
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect
```

### 2. ì—”í‹°í‹° ì„¤ê³„ ê·œì¹™
```java
@Entity
@Table(name = "users")
@Getter
@Setter
@NoArgsConstructor
public class User {
    @Id @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @Column(nullable = false, unique = true)
    private String email;

    @Column(nullable = false)
    private String nickname;

    // ìƒì„±/ìˆ˜ì • ì‹œê°„
    private LocalDateTime createdAt = LocalDateTime.now();
    private LocalDateTime updatedAt = LocalDateTime.now();
}
```

### 3. Repository ë©”ì„œë“œ ëª…ëª…
```java
// ê¸°ë³¸ CRUD
Optional<User> findByEmail(String email);
boolean existsByEmail(String email);
Optional<User> findByNickname(String nickname);
boolean existsByNickname(String nickname);

// ë³µí•© ì¡°ê±´
Page<User> findByUsernameContainingOrNicknameContaining(String username, String nickname, Pageable pageable);
long countByCreatedAtBetween(LocalDateTime start, LocalDateTime end);
```

## ğŸ”§ ë¹Œë“œ ë° ì‹¤í–‰ ê·œì¹™

### 1. í™˜ê²½ë³„ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
```bash
# ë¡œì»¬ ê°œë°œ í™˜ê²½
./run-local.sh

# H2 ë°ì´í„°ë² ì´ìŠ¤ (í…ŒìŠ¤íŠ¸ìš©)
./run-h2.sh

# MySQL ë°ì´í„°ë² ì´ìŠ¤
./run-mysql.sh

# ìš´ì˜ í™˜ê²½
./run-prod.sh
```

### 2. í™˜ê²½ë³€ìˆ˜ ì„¤ì •
```bash
# ë¡œì»¬ í™˜ê²½ ë³€ìˆ˜
export MYSQL_USERNAME=root
export MYSQL_PASSWORD=rookie123
export JWT_SECRET=local-secret-key-for-development-only
export JWT_EXPIRATION=86400000
export SERVER_PORT=8080
export SPRING_PROFILES_ACTIVE=local
```

### 3. ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”
```bash
# MySQL ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±
mysql -u root -prookie123 -e "CREATE DATABASE IF NOT EXISTS rookie_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;"

# MySQL ì—°ê²° í…ŒìŠ¤íŠ¸
./test-mysql-connection.sh
```

## âš ï¸ ìì£¼ ë°œìƒí•˜ëŠ” ì—ëŸ¬ ë° í•´ê²°ë°©ë²•

### 1. ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì˜¤ë¥˜
**ì—ëŸ¬**: `Communications link failure`
**ì›ì¸**: MySQL ì„œë²„ê°€ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ
**í•´ê²°**:
```bash
# MySQL ì„œë¹„ìŠ¤ ì‹œì‘
brew services start mysql

# ì—°ê²° í™•ì¸
mysql -u root -prookie123 -e "SELECT 1;"
```

### 2. í…Œì´ë¸” ì—†ìŒ ì˜¤ë¥˜
**ì—ëŸ¬**: `Table 'rookie_db.users' doesn't exist`
**ì›ì¸**: DDL_AUTO ì„¤ì • ë¬¸ì œ
**í•´ê²°**:
```properties
# application-local.properties
spring.jpa.hibernate.ddl-auto=create
```

### 3. JPA ì—”í‹°í‹° ì¸ì‹ ì‹¤íŒ¨
**ì—ëŸ¬**: `Not a managed type`
**ì›ì¸**: íŒ¨í‚¤ì§€ ìŠ¤ìº” ë¬¸ì œ
**í•´ê²°**:
```java
@SpringBootApplication
@EntityScan("com.bootcampbox.server.domain")
public class RookiePxServerApplication {
    public static void main(String[] args) {
        SpringApplication.run(RookiePxServerApplication.class, args);
    }
}
```

### 4. í¬íŠ¸ ì¶©ëŒ ì˜¤ë¥˜
**ì—ëŸ¬**: `Port 8080 is already in use`
**í•´ê²°**:
```bash
# í¬íŠ¸ ì‚¬ìš© ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ í™•ì¸
lsof -i :8080

# í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ
kill -9 <PID>

# ë˜ëŠ” ë‹¤ë¥¸ í¬íŠ¸ ì‚¬ìš©
export SERVER_PORT=8081
```

### 5. JWT í† í° ì˜¤ë¥˜
**ì—ëŸ¬**: `JWT signature does not match`
**ì›ì¸**: JWT_SECRET ë¶ˆì¼ì¹˜
**í•´ê²°**:
```bash
# í™˜ê²½ë³€ìˆ˜ í™•ì¸
echo $JWT_SECRET

# ì¬ì„¤ì •
export JWT_SECRET=local-secret-key-for-development-only
```

### 6. Gradle ë¹Œë“œ ì˜¤ë¥˜
**ì—ëŸ¬**: `Could not resolve dependencies`
**í•´ê²°**:
```bash
# Gradle ìºì‹œ ì •ë¦¬
./gradlew clean

# ì˜ì¡´ì„± ìƒˆë¡œê³ ì¹¨
./gradlew --refresh-dependencies
```

### 7. ë©”ëª¨ë¦¬ ë¶€ì¡± ì˜¤ë¥˜
**ì—ëŸ¬**: `OutOfMemoryError`
**í•´ê²°**:
```bash
# JVM ë©”ëª¨ë¦¬ ì„¤ì •
export GRADLE_OPTS="-Xmx2048m -XX:MaxPermSize=512m"
```

## ğŸš€ API ê°œë°œ ê·œì¹™

### 1. REST API ì„¤ê³„
```java
// GET: ì¡°íšŒ
@GetMapping("/api/users/{id}")
public ResponseEntity<UserDto> getUser(@PathVariable Long id)

// POST: ìƒì„±
@PostMapping("/api/auth/signup")
public ResponseEntity<UserDto> signUp(@RequestBody UserDto.SignUpRequest request)

// PUT: ì „ì²´ ìˆ˜ì •
@PutMapping("/api/users/{id}")
public ResponseEntity<UserDto> updateUser(@PathVariable Long id, @RequestBody UserDto.UpdateRequest request)

// PATCH: ë¶€ë¶„ ìˆ˜ì •
@PatchMapping("/api/users/{id}")
public ResponseEntity<UserDto> partialUpdateUser(@PathVariable Long id, @RequestBody UserDto.PartialUpdateRequest request)

// DELETE: ì‚­ì œ
@DeleteMapping("/api/users/{id}")
public ResponseEntity<Void> deleteUser(@PathVariable Long id)
```

### 2. ì‘ë‹µ í˜•ì‹ í†µì¼
```java
// ì„±ê³µ ì‘ë‹µ
{
  "message": "íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.",
  "success": true,
  "data": { ... }
}

// ì—ëŸ¬ ì‘ë‹µ
{
  "message": "ì´ë¯¸ ê°€ì…ëœ ì´ë©”ì¼ì…ë‹ˆë‹¤.",
  "success": false,
  "error": "DUPLICATE_EMAIL"
}
```

### 3. ë³´ì•ˆ ì„¤ì •
```java
// ì¸ì¦ í•„ìš” API
@PreAuthorize("hasRole('USER')")
@GetMapping("/api/user/me")
public ResponseEntity<UserDto> getMyInfo()

// ê´€ë¦¬ì ì „ìš© API
@PreAuthorize("hasRole('ADMIN')")
@GetMapping("/api/admin/users")
public ResponseEntity<AdminDto.UserListResponse> getAllUsers()
```

### 6. ì—ëŸ¬ ì‘ë‹µ ìƒì„¸í™”
- ëª¨ë“  API ì—ëŸ¬ëŠ” ì¼ê´€ëœ JSON êµ¬ì¡°ë¡œ ë°˜í™˜í•œë‹¤.
- message, success, error(ì½”ë“œ/í´ë˜ìŠ¤), timestamp í•„ë“œë¥¼ í¬í•¨í•œë‹¤.
- ê¸€ë¡œë²Œ ì˜ˆì™¸ í•¸ë“¤ëŸ¬(@RestControllerAdvice)ì—ì„œ ì²˜ë¦¬í•œë‹¤.
- ì˜ˆì‹œ:
```json
{
  "message": "ì´ë¯¸ ê°€ì…ëœ ì´ë©”ì¼ì…ë‹ˆë‹¤.",
  "success": false,
  "error": "IllegalArgumentException",
  "timestamp": "2025-07-10T23:00:00"
}
```

## ğŸ“š ìœ ìš©í•œ ëª…ë ¹ì–´

### 1. ì„œë²„ ê´€ë¦¬
```bash
# ì„œë²„ ì‹œì‘
./run-local.sh

# ì„œë²„ ì¤‘ì§€
pkill -f "RookiePxServerApplication"

# ë¡œê·¸ í™•ì¸
tail -f logs/application.log
```

### 2. ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬
```bash
# MySQL ì ‘ì†
mysql -u root -prookie123

# ë°ì´í„°ë² ì´ìŠ¤ ëª©ë¡
SHOW DATABASES;

# í…Œì´ë¸” ëª©ë¡
USE rookie_db;
SHOW TABLES;
```

### 3. API í…ŒìŠ¤íŠ¸
```bash
# ì´ë©”ì¼ ì¤‘ë³µí™•ì¸
curl -X POST http://localhost:8080/api/auth/check-duplicate \
  -H "Content-Type: application/json" \
  -d '{"type": "email", "value": "test@example.com"}'

# íšŒì›ê°€ì…
curl -X POST http://localhost:8080/api/auth/signup \
  -H "Content-Type: application/json" \
  -d '{"email": "test@example.com", "password": "password123", "nickname": "testuser"}'
```

## ğŸ” ë””ë²„ê¹… íŒ

### 1. ë¡œê·¸ ë ˆë²¨ ì¡°ì •
```properties
# ìƒì„¸í•œ SQL ë¡œê·¸
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# Spring Security ë¡œê·¸
logging.level.org.springframework.security=DEBUG
```

### 2. í”„ë¡œíŒŒì¼ ì‚¬ìš©
```bash
# ë¡œì»¬ í”„ë¡œíŒŒì¼
export SPRING_PROFILES_ACTIVE=local

# ìš´ì˜ í”„ë¡œíŒŒì¼
export SPRING_PROFILES_ACTIVE=prod
```

### 3. ë°ì´í„°ë² ì´ìŠ¤ ëª¨ë‹ˆí„°ë§
```sql
-- í™œì„± ì—°ê²° í™•ì¸
SHOW PROCESSLIST;

-- í…Œì´ë¸” ìƒíƒœ í™•ì¸
SHOW TABLE STATUS;
```

## ğŸŒ± í™˜ê²½ë³€ìˆ˜ ê´€ë¦¬ ê·œì¹™

### 1. í™˜ê²½ë³€ìˆ˜ íŒŒì¼
- í™˜ê²½ë³€ìˆ˜ëŠ” `.env`, `env.sh`, ë˜ëŠ” `env-example.sh` íŒŒì¼ë¡œ ê´€ë¦¬í•œë‹¤.
- ì‹¤ì œ ë°°í¬/ê°œë°œ í™˜ê²½ì—ì„œëŠ” `.env` ë˜ëŠ” `env.sh` íŒŒì¼ì„ ì‚¬ìš©í•˜ê³ , ì˜ˆì‹œ/í…œí”Œë¦¿ì€ `env-example.sh`ë¡œ ì œê³µí•œë‹¤.
- í™˜ê²½ë³€ìˆ˜ íŒŒì¼ì—ëŠ” DB, JWT, ì„œë²„ í¬íŠ¸, ë¡œê¹… ë“± ëª¨ë“  ë¯¼ê° ì •ë³´ì™€ ì„¤ì •ê°’ì„ í¬í•¨í•œë‹¤.

### 2. í™˜ê²½ë³€ìˆ˜ ì ìš© ë°©ë²•
- ì„œë²„ ì‹¤í–‰ ì „ ë°˜ë“œì‹œ í™˜ê²½ë³€ìˆ˜ë¥¼ ë¡œë“œí•´ì•¼ í•œë‹¤.
- `source env.sh` ë˜ëŠ” `source ./load-env.sh` ëª…ë ¹ì–´ë¡œ í™˜ê²½ë³€ìˆ˜ë¥¼ ì ìš©í•œë‹¤.
- í™˜ê²½ë³€ìˆ˜ íŒŒì¼ì´ ì—†ì„ ê²½ìš°, `env-example.sh`ë¥¼ ë³µì‚¬í•˜ì—¬ ì‚¬ìš©í•œë‹¤.
  ```bash
  cp env-example.sh env.sh
  vi env.sh # ì‹¤ì œ ê°’ìœ¼ë¡œ ìˆ˜ì •
  source env.sh
  ```
- CI/CD, ìš´ì˜ í™˜ê²½ì—ì„œëŠ” `.env` ë˜ëŠ” `env.sh`ë¥¼ í™˜ê²½ë³„ë¡œ ë³„ë„ ê´€ë¦¬í•œë‹¤.

### 3. í™˜ê²½ë³€ìˆ˜ ì£¼ìš” í•­ëª© ì˜ˆì‹œ
```bash
# Database
export DB_URL=jdbc:mysql://localhost:3306/rookie_db?useSSL=false&serverTimezone=UTC&characterEncoding=UTF-8&allowPublicKeyRetrieval=true
export DB_USERNAME=root
export DB_PASSWORD=rookie123

# JWT
export JWT_SECRET=local-secret-key-for-development-only
export JWT_EXPIRATION=86400000

# Server
export SERVER_PORT=8080
export SPRING_PROFILES_ACTIVE=local
```

### 4. í™˜ê²½ë³€ìˆ˜ ìë™ ë¡œë”© ìŠ¤í¬ë¦½íŠ¸
- `load-env.sh` ìŠ¤í¬ë¦½íŠ¸ë¡œ env.sh íŒŒì¼ì´ ìˆìœ¼ë©´ ìë™ìœ¼ë¡œ ë¡œë“œ, ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ ì‚¬ìš©
- run-local.sh, run-mysql.sh ë“± ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ë°˜ë“œì‹œ `source ./load-env.sh`ë¡œ í™˜ê²½ë³€ìˆ˜ ì ìš© í›„ ì„œë²„ ì‹¤í–‰

### 5. ë³´ì•ˆ
- `.env`, `env.sh` ë“± ì‹¤ì œ í™˜ê²½ë³€ìˆ˜ íŒŒì¼ì€ gitì— ì»¤ë°‹í•˜ì§€ ì•ŠëŠ”ë‹¤. (ì˜ˆì‹œ íŒŒì¼ë§Œ ì»¤ë°‹)
- ë¯¼ê° ì •ë³´(ë¹„ë°€ë²ˆí˜¸, ì‹œí¬ë¦¿í‚¤ ë“±)ëŠ” ë°˜ë“œì‹œ í™˜ê²½ë³€ìˆ˜ë¡œë§Œ ê´€ë¦¬í•œë‹¤.

ì´ ê·œì¹™ë“¤ì„ ë”°ë¼ ê°œë°œí•˜ë©´ ì¼ê´€ì„± ìˆê³  ìœ ì§€ë³´ìˆ˜í•˜ê¸° ì‰¬ìš´ ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤! ğŸš€ 